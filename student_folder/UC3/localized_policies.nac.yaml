---
# Localized Policies
sdwan:
  localized_policies:
    definitions:
      ipv4_access_control_lists:
        - name: ACL-NETCONF830-DROP
          description: Drop traffic to netconf port
          default_action: accept
          sequences:
            - id: 10
              base_action: drop
              match_criterias:
                destination_ports:
                  - 830
                destination_ip_prefix: 10.1.1.1/32
              actions:
                counter_name: 10-DROP-NETCONF
        - name: ACL-GRE-DROP
          description: Drop non-encrypted tunneled traffic GRE IPIP
          default_action: accept
          sequences:
            - id: 10
              base_action: drop
              match_criterias:
                protocols:
                  - 47
                  - 94
              actions:
                counter_name: 10-DROP-TUNNEL
        - name: ACL-SET-NEXTHOP
          description: set nexthop
          default_action: accept
          sequences:
            - id: 1
              base_action: accept
              match_criterias:
                destination_data_prefix_list: DPL-DEFAULT
                tcp: syn
              actions:
                dscp: 0
                next_hop: 10.1.1.1
                counter_name: INTERNET
                log: true
                class: CLASS-DEFAULT
      ipv4_device_access_policies:
        - name: ACL-DEVICEACCESSPOLICY-01
          description: SSH and SNMP access control
          default_action: drop
          sequences:
            - id: 10
              base_action: accept
              match_criterias:
                source_ip_prefix: 10.10.0.0/16
                destination_port: 22
              counter_name: SEQ10-SSH
            - id: 15
              base_action: accept
              match_criterias:
                source_ip_prefix: 192.168.1.5/32
                destination_port: 22
              counter_name: SEQ15-SSH-VMANAGE
            - id: 20
              base_action: accept
              match_criterias:
                source_ip_prefix: 10.0.10.0/24
                destination_port: 22
              counter_name: SEQ15-SSH
            - id: 25
              base_action: accept
              match_criterias:
                source_ip_prefix: 10.0.10.0/24
                destination_port: 161
              counter_name: SEQ20-SNMP
      qos_maps:
        - name: QOS-MAP-1P4Q
          description: 1-prio 4-red queue qos-map
          qos_schedulers:
            - queue: 0
              bandwidth_percent: 10
              buffer_percent: 10
              burst_bytes: 200000
              scheduling_type: llq
              drop_type: tail-drop
              class_map: CLASS-REALTIME
            - queue: 1
              bandwidth_percent: 40
              buffer_percent: 40
              scheduling_type: wrr
              drop_type: red-drop
              class_map: CLASS-BUSINESS
            - queue: 2
              bandwidth_percent: 15
              buffer_percent: 15
              scheduling_type: wrr
              drop_type: red-drop
              class_map: CLASS-DEFAULT
            - queue: 3
              bandwidth_percent: 25
              buffer_percent: 25
              scheduling_type: wrr
              drop_type: red-drop
              class_map: CLASS-BULK
            - queue: 4
              bandwidth_percent: 10
              buffer_percent: 10
              scheduling_type: wrr
              drop_type: red-drop
              class_map: CLASS-LOW-PRIORITY
      route_policies:
        - name: ROUTE-MAP-PL
          description: ADD TRACK PL
          default_action: accept
          sequences:
            - id: 10
              ip_type: ipv4
              base_action: accept
              match_criterias:
                prefix_list: PL-DC-VPN10-LOOPBACKs
            - id: 20
              ip_type: ipv4
              base_action: accept
              match_criterias:
                prefix_list: PL-DC-VPN11-LOOPBACKs
        - name: RM-SITE-BGP-OUT-ACTIVE
          description: BGP out - active router for the VPN
          default_action: accept
          sequences:
            - id: 1
              ip_type: ipv4
              base_action: accept
              actions:
                metric: 100
        - name: RM-SITE-BGP-OUT-STANDBY
          description: BGP out - standby router for the VPN
          default_action: accept
          sequences:
            - id: 1
              ip_type: ipv4
              base_action: accept
              actions:
                metric: 200
        - name: RM-SITE-BGP-TO-OMP-ACTIVE
          description: BGP to OMP - Active router for the VPN
          default_action: accept
          sequences:
            - id: 1
              ip_type: ipv4
              base_action: accept
              actions:
                omp_tag: 1111
        - name: RM-SITE-BGP-TO-OMP-STANDBY
          description: BGP to OMP - Standby router for the VPN
          default_action: accept
          sequences:
            - id: 1
              ip_type: ipv4
              base_action: accept
              actions:
                omp_tag: 2222
        - name: RM-SITE-OMP-TO-OSPF-ACTIVE
          description: OMP to OSPF - Active router for the VPN 10 and 11
          default_action: accept
          sequences:
            - id: 1
              ip_type: ipv4
              base_action: accept
              actions:
                metric: 100
                metric_type: type2
        - name: RM-SITE-OMP-TO-OSPF-STANDBY
          description: OMP to OSPF - Active router for the VPN 10 and 11
          default_action: accept
          sequences:
            - id: 1
              ip_type: ipv4
              base_action: accept
              actions:
                metric: 200
                metric_type: type2
    feature_policies:
      - name: LOCAL-POLICY-BGP-01
        description: Localized Policy | BGP Site v01
        ipv4_application_visibility: true
        ipv6_application_visibility: false
        ipv4_flow_visibility: true
        ipv6_flow_visibility: false
        implicit_acl_logging: false
        ipv4_visibility_cache_entries: 1000
        ipv6_visibility_cache_entries: 1000
        log_frequency: 1024
        definitions:
          qos_maps:
            - QOS-MAP-1P4Q
          route_policies:
            - RM-SITE-BGP-OUT-ACTIVE
            - RM-SITE-BGP-OUT-STANDBY
            - RM-SITE-BGP-TO-OMP-ACTIVE
            - RM-SITE-BGP-TO-OMP-STANDBY
          ipv4_device_access_policies:
            - ACL-DEVICEACCESSPOLICY-01
      - name: LOCAL-POLICY-OSPF-01
        description: Localized Policy v01
        ipv4_application_visibility: true
        ipv6_application_visibility: false
        ipv4_flow_visibility: true
        ipv6_flow_visibility: false
        implicit_acl_logging: false
        ipv4_visibility_cache_entries: 1000
        ipv6_visibility_cache_entries: 1000
        log_frequency: 1024
        definitions:
          qos_maps:
            - QOS-MAP-1P4Q
          route_policies:
            - RM-SITE-OMP-TO-OSPF-ACTIVE
            - RM-SITE-OMP-TO-OSPF-Standby
          ipv4_device_access_policies:
            - ACL-DEVICEACCESSPOLICY-01
      - name: LOCAL-POLICY-LAN-01
        description: Localized Policy v01
        ipv4_application_visibility: true
        ipv6_application_visibility: false
        ipv4_flow_visibility: true
        ipv6_flow_visibility: false
        implicit_acl_logging: false
        ipv4_visibility_cache_entries: 1000
        ipv6_visibility_cache_entries: 1000
        log_frequency: 1024
        definitions:
          qos_maps:
            - QOS-MAP-1P4Q
          route_policies:
            - ROUTE-MAP-PL
          ipv4_device_access_policies:
            - ACL-DEVICEACCESSPOLICY-01
